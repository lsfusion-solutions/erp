MODULE ZReportPrescription;

REQUIRE ZReport, EquipmentCashRegister;

NAMESPACE ZReport;

@defineExternalizable(ReceiptSaleDetail, STRING[100], ext);

id = DATA LOCAL STRING[100] (INTEGER);
value = DATA LOCAL STRING[100] (INTEGER);

FORM import
    OBJECTS extDocId = INTEGER
    PROPERTIES(extDocId) id, value
    FILTERS imported(extDocId)
;

processReceiptDetailExtraFields(STRING json) + {
    logToFile('ExtraFields',(OVERRIDE json,'NULL'));
    
    stringToFile(json,'UTF-8','json');
    IMPORT import JSON FROM resultFile();
    FOR id(ReceiptDetail d) == id(INTEGER i) AND value(i) DO {
        extId(d) <- value(i);
    }

    APPLY;
}