MODULE RangePurchaseOrderStock;

REQUIRE PurchaseOrder, Range, PurchaseDemand;

NAMESPACE Range;

useRange 'Использовать ассортиментную матрицу' = ABSTRACT BOOLEAN (Stock) MATERIALIZED;

EXTEND FORM userOrder
    FILTERGROUP filter2
        FILTER 'В ассортименте' countRange(ks, st, date(o)) 'F4';
;

limitRecommendedQuantity(Sku s, UserOrder o) += s IS Sku AND useRange(customerStock(o)) AND NOT countRange(s, customerStock(o), date(o));