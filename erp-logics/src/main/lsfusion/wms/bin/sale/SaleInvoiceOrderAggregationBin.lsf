MODULE SaleInvoiceOrderAggregationBin;

REQUIRE SaleInvoiceOrderAggregation, BinLedger, SaleBinLedger;

NAMESPACE Sale;

@defineDocumentBins(order, out, ' (из)');

outBin(OrderInvoiceDetail detail) = outBin(orderDetail(detail));

@implementAggregationBinLedger(orderInvoiceDetail, orderInvoice, OrderInvoice, sku, quantity, supplierStock);
@implementBinLedger(orderInvoiceBinLedger, orderInvoiceDetail, sku, quantity, supplierStock, outBin);
needToCreate(OrderInvoiceDetail detail) += TRUE IF outBin(detail);

@setBinDocument(UserOrder, supplierStock, out);
@defineBinDocumentConstraintsType(userOrder, supplierStock, out);

backgroundBins 'Цвет' (UserOrder order) = RGB(255, 224, 255) IF order IS UserOrder;
backgroundBins (UserOrderDetail detail) = backgroundBins(order(detail));

@extendObjectFormsBins(userOrder, orders, o, supplierStock, backgroundBins, out);

DESIGN userOrder {
    headerExtraParams {
        lines = 4;
    }
}

@deriveDocumentOperationProperty(UserOrder, useBins);

@deriveDocumentBins (userOrder, userOrder, outBin, outBin, supplierStock);