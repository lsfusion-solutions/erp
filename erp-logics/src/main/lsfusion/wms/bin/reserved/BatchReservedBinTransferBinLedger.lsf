MODULE BatchReservedBinTransferBinLedger;

REQUIRE ReservedBinTransferBinLedger, BatchReservedBinLedger, BatchBinTransferBinLedger;

NAMESPACE Bin;

batch[ReservedBinLedger](BinTransferDetail ledger) += batch(ledger);

CONSTRAINT CHANGED(outBin(UserBinTransferDetail detail)) AND detail IS UserBinTransferDetail AND NOT prevAvailableQuantity(batch(detail), outBin(detail))
    CHECKED BY outBin[UserBinTransferDetail]
    MESSAGE 'Нет доступного кол-ва партии в ячейке';

EXTEND FORM userBinTransfer
    PROPERTIES READONLY availableQuantityOutBin 'Доступно в ячейки (из)' = prevAvailableQuantity(batch(d), outBin(d)) AFTER nameOutBin(d),
        availableQuantityInBin 'Доступно в ячейки (в)' = prevAvailableQuantity(batch(d), inBin(d)) AFTER nameInBin(d)
;