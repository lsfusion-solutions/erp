MODULE SaleInvoiceFixedVATRu;

REQUIRE SaleInvoiceRu, LegalEntityFixedVATRu;

NAMESPACE Sale;

overVAT(UserInvoiceDetail d) += CASE WHEN isFixedVAT(supplier(d)) THEN fixedVAT(supplier(d), date(d))
    WHEN isNotVATPayer(supplier(d)) THEN valueCurrentVAT(country(supplierStock(d)), 0.0)
    ELSE NULL;

