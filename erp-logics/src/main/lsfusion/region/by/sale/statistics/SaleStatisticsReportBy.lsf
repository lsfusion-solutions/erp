MODULE SaleStatisticsReportBy;

REQUIRE SaleStatisticsReportStore, SaleStatisticsBy;

NAMESPACE Sale;

fromMonth(StatisticReport r) = extractMonthName(fromDate(r));
toMonth(StatisticReport r) = extractMonthName(toDate(r));

caption (StatisticReport r)= CASE 
    WHEN reportKind(r) == ReportKind.stock THEN CONCAT ': ',staticCaption(reportKind(r)), nameStock(r)
    WHEN reportKind(r) == ReportKind.region THEN CONCAT ': ',staticCaption(reportKind(r)), nameRegion(r)
    WHEN reportKind(r) == ReportKind.consolidate THEN CONCAT ': ',staticCaption(reportKind(r)), consolidateStocks(r);

FORM statisticReport1Print '1-торг (розница)'

    OBJECTS r = StatisticReport PANEL SUBREPORT 
    PROPERTIES (r) READONLY name, nameStock,  fullNameLegalEntityStock, 
                   addressLegalEntityStock, addressStock,
                   note, fromDate, toDate,   
                   fromMonth, toMonth, caption
                
    PROPERTIES (r) READONLY countStatisticReportDetail
    PROPERTIES (r) NEWSESSION NEW, EDIT, deleter=DELETE TOOLBAR  
    PROPERTIES (r) READONLY  createdNameUser, createdTime, createdHostnameComputer 
        
    OBJECTS d = StatisticReportDetail
    PROPERTIES (d) READONLY index, name, number, nameStatisticGroup,
                   sidStatisticGroup,   
                   soldSum, soldSumCorporate, soldSumInternet, soldSumResident, balanceSum 
    ORDERS index(d)

    FILTERS statisticReport(d) == r
;
statistic1Print '1-торг (розница)' (StatisticReport r)  { PRINT statisticReport1Print OBJECTS r =r; }   IMAGE 'print.png' IN print;   
excel1Print '1-торг (розница) (xls)' (StatisticReport r)  { PRINT statisticReport1Print OBJECTS r =r XLSX; }  IMAGE 'print.png' IN print;   

EXTEND FORM statisticReports
    PROPERTIES  statistic1Print(r), excel1Print(r) 
;


statisticGroup2R4T'Строки для 4 торг 2 раздел'(StatisticReportDetail d)= number(d) == '80' OR number(d) == '81' OR number(d) == '82' OR number(d) == '83' OR index(d)==89;

FORM statisticReport4Print '4-торг (продажа)'

    OBJECTS r = StatisticReport PANEL SUBREPORT 
    PROPERTIES (r) READONLY name, nameStock,  fullNameLegalEntityStock, 
                   addressLegalEntityStock, addressStock,
                   note, fromDate, toDate,   
                   fromMonth, toMonth, caption
                
    PROPERTIES (r) READONLY countStatisticReportDetail, createdNameUser, createdTime, createdHostnameComputer 
        
    OBJECTS d = StatisticReportDetail
    PROPERTIES (d) READONLY index, name, number, nameStatisticGroup, sidStatisticGroup, nameUOM, 
        sold, soldResident, balance, balanceResident, prevYearSold, soldCatering, prevYearSoldCatering 
    ORDERS index(d)

    FILTERS statisticReport(d) == r AND NOT statisticGroup2R4T(d)
;

FORM statisticGroup2R4T '4-торг 2 раздел'

    OBJECTS r = StatisticReport PANEL SUBREPORT
    PROPERTIES (r) READONLY name, nameStock,  fullNameLegalEntityStock,addressLegalEntityStock, addressStock,note, fromDate, toDate,
        fromMonth, toMonth, caption
    PROPERTIES (r) READONLY countStatisticReportDetail, createdNameUser, createdTime, createdHostnameComputer

    OBJECTS d = StatisticReportDetail
    PROPERTIES (d) READONLY index, name, number, nameStatisticGroup, sidStatisticGroup,  soldSum, soldSumResident, soldSumCash, soldSumCashCatering
    ORDERS index(d)

    FILTERS statisticReport(d) == r AND statisticGroup2R4T(d)
;

statistic4Print '4-торг (продажа)' (StatisticReport r)  { PRINT statisticReport4Print OBJECTS r =r; PRINT statisticGroup2R4T OBJECTS r =r; }   IMAGE 'print.png' IN print;   
excel4Print '4-торг (продажа) (xls)' (StatisticReport r)  { PRINT statisticReport4Print OBJECTS r =r XLSX; PRINT statisticGroup2R4T OBJECTS r =r XLSX;}  IMAGE 'print.png' IN print;

EXTEND FORM statisticReports
    PROPERTIES (r) statistic4Print, excel4Print
;

FORM statisticReport124Print '1-торг таб 4'

    OBJECTS r = StatisticReport PANEL 
    PROPERTIES (r) READONLY name, nameStock,  fullNameLegalEntityStock, 
                   addressLegalEntityStock, addressStock,
                   note, fromDate, toDate,   
                   fromMonth, toMonth, caption
                
    PROPERTIES (r) READONLY countStatisticReportDetail
    PROPERTIES (r) READONLY  createdNameUser, createdTime, createdHostnameComputer 
        
    OBJECTS d = StatisticReportDetail
    PROPERTIES (d) READONLY index, name, number, nameStatisticGroup,
                   sidStatisticGroup, nameUOM,  
                   sold, soldResident, balance, balanceResident 
    ORDERS index(d)

    FILTERS statisticReport(d) == r
;
statistic124Print '1-торг таб 4' (StatisticReport r)  { PRINT statisticReport124Print OBJECTS r =r; }   IMAGE 'print.png' IN print;   
excel124Print '1-торг таб 4 (xls)' (StatisticReport r)  { PRINT statisticReport124Print OBJECTS r =r XLSX; }  IMAGE 'print.png' IN print;   

EXTEND FORM statisticReports
    PROPERTIES  statistic124Print(r), excel124Print(r) 
;

FORM statisticReport12Print '12-торг (товарооборот)'

    OBJECTS r = StatisticReport PANEL SUBREPORT 
    PROPERTIES (r) READONLY name, nameStock,  fullNameLegalEntityStock, 
                   addressLegalEntityStock, addressStock,
                   note, fromDate, toDate,   
                   fromMonth, toMonth, caption
                
    PROPERTIES (r) READONLY countStatisticReportDetail
    PROPERTIES (r) NEWSESSION NEW, EDIT, deleter=DELETE TOOLBAR  
    PROPERTIES (r) READONLY  createdNameUser, createdTime, createdHostnameComputer 
        
    OBJECTS d = StatisticReportDetail
    PROPERTIES (d) READONLY index, name, number, nameStatisticGroup, sidStatisticGroup, nameUOM,
        soldSum, prevYearSoldSum 
    ORDERS index(d)

    FILTERS statisticReport(d) == r
;
statistic12Print '12-торг (товарооборот)' (StatisticReport r)  { PRINT statisticReport12Print OBJECTS r =r; }   IMAGE 'print.png' IN print;   
excel12Print '12-торг (товарооборот) (xls)' (StatisticReport r)  { PRINT statisticReport12Print OBJECTS r =r XLSX; }  IMAGE 'print.png' IN print;   

EXTEND FORM statisticReports
    PROPERTIES  statistic12Print(r), excel12Print(r) 
;

DESIGN statisticReports {
    printContainer{
        MOVE GROUP(print,r);
    }
}

loadDefaultStStatisticReportTypeBy2021torg1tab4(){

    loadDefaultStatisticReportType ('1-торг(2021) таблица 4', 'BYRTNEW', NULL , NULL);   
     
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 1, 'Мясо, включая птицу и субпродукты пищевые (47.22.11)', '400', '47.22.11', 'т', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 2, 'Мясные продукты (47.22.12)', '401', '47.22.12', 'т', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 3, 'Рыба, ракообразные и моллюски (47.23.1)', '402', '47.23.1', 'т', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 4, 'Мучные кондитерские изделия (47.24.11.200)', '403', '47.24.11.200', 'т', 1);      
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 5, 'Сахаристые кондитерские изделия (47.24.12)', '404', '47.24.12', 'т', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 6, 'Табачные изделия (47.26.10)', '405', '47.26.10', 'тыс.шт', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 7, 'Сыры (47.29.11.120)', '406', '47.29.11.120', 'т', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 8, 'Масло сливочное (47.29.11.130)', '407', '47.29.11.130', 'т', 1);        
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 9, 'Яйца(47.29.12)', '408', '47.29.12', 'тыс.шт', 1);   
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 10,'Масло растительное (47.29.22.200)', '409', '47.29.22.200', 'т', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 11,'Маргарин (47.29.22.310)', '410', '47.29.22.310', 'т', 1); 
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 12,'Крупа (47.29.29.200)', '411', '47.29.29.200', 'т', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 13,'Сахар и сахарозаменители (47.29.29.400)', '412', '47.29.29.400', 'т', 1); 
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 14,'Соль пищевая (47.29.29.600)', '413', '47.29.29.600', 'т', 1); 
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 15,'Мука (47.29.29.700)', '414', '47.29.29.700', 'т', 1);       
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 16,'Макаронне изделия (47.29.29.800)', '415', '47.29.29.800', 'т', 1); 
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 17,'Новые легковые автомобили (45.11.21)', '416', '45.11.21', 'шт', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 18,'Поддержанные легковые автомобили (45.11.22)', '417', '45.11.22', 'шт', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 19,'Шины для легковых пассажирских автомобилей (45.32.11.200)', '418', '45.32.11.200', 'шт', 1);      
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 20,'Телевизоры (47.43.10.210)', '419', '47.43.10.210', 'шт', 0);         
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 21,'Стекло (47.52.13)', '420', '47.52.13', 'м2', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 22,'Пиломатериалы (47.52.16.220)', '421', '47.52.16.220', 'м3', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 23,'Фанера клееная (47.52.16.261)', '422', '47.52.16.261', 'м3', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 24,'Древесно-волокнистые плиты (47.52.16.262)', '423', '47.52.16.262', 'м2', 1);       
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 25,'Древесно-стружечные плиты (47.52.16.263)', '424', '47.52.16.263', 'м2', 1);             
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 26,'Цемент (47.52.16.310)', '425', '47.52.16.310', 'т', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 27,'Плитка керамическая (47.52.16.510)', '426', '47.52.16.510', 'м2', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 28,'Ковры и изделия ковровые (47.53.12.300)', '427', '47.53.12.300', 'м2', 1); 
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 29,'Холодильники и морозильные бытовые (47.54.10.110)', '428', '47.54.10.110', 'шт', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 30,'Стиральные машины бытовые и машины для сушки одежды (47.54.10.120)', '429', '47.54.10.120', 'шт', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 31,'Чистящие и прочие средства бытовой химии (47.59.19.400)', '430', '47.59.19.400', 'т', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 32,  'из них мыло хозяйственное (47.59.19.440)', '431', '47.59.19.440', 'т', 1);  
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 33,'Велосипеды (47.64.10.100)', '432', '47.64.10.100', 'шт', 1);   
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 34,'Одежда трикотажная (47.71.10.110)', '433', '47.71.10.110', 'шт', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 35,'Корсетные изделия(47.71.10.210)', '434', '47.71.10.210', 'шт', 1);        
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 36,'Чулочно-носочные иделия (47.71.10.600)', '435', '47.71.10.600', 'пар', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 37,'Обувь (47.72.11)', '436', '47.72.11', 'пар', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021) таблица 4', 38,'Мыло туалетное (47.75.10.300)', '437', '47.75.10.300', 'т', 1);       
}

loadDefaultStStatisticReportTypeBy2021(){
    loadDefaultStatisticReportType ('1-торг(2021)', 'BYRTNEW', TRUE , 1000);
        
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 1, 'Всего (сумма строк 201 и 262)', '200', 'ВСЕ', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 2, ' в том числе по товарным группам:', NULL, NULL, NULL, NULL);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 3, '   пищевые продукты, включая напитки и табачные изделия (47.2) (сумма строк с 202, 203, 205, 208, 216, 219, 222, 223,230, 235, 236, 242, 243, 247, с 250 по 252, с 255 по 259)', '201', '47.2', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 4, '     в том числе:', NULL, NULL, NULL, NULL); 
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 5, '      свежие фрукты и орехи (47.21.11.100) ', '202', '47.21.11.100', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 6, '      свежие овощи и грибы  (47.21.11.300) ', '203', '47.21.11.300', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 7, '            из них свежий картофель  (47.21.11.310) ', '204', '47.21.11.310', 'тысяч  рублей', 1); 
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 8, '      обработанные фрукты и овощи (47.21.12) ', '205', '47.21.12', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 9, '            из них обработанные фрукты и орехи (47.21.12.100) ', '206', '47.21.12.100', 'тысяч  рублей', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 10, '               из них джемы, желе, пюре или пасты фруктовые и ореховые (47.21.12.110) ', '207', '47.21.12.110', 'тысяч  рублей', 1);   
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 11, '      мясо и мясные продукты (47.22.1) (сумма строк 209 и 214)  ', '208', '47.22.1', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 12, '    в том числе:', NULL, NULL, NULL, NULL);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 13, '         мясо, включая птицу и субпродукты пищевые (47.22.11) ', '209', '47.22.11', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 14, '            из него:', NULL, NULL, NULL, NULL); 
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 15, '               мясо (47.22.11.100) ', '210', '47.22.11.100', 'тысяч  рублей', 1);   
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 16, '                из него:', NULL, NULL, NULL, NULL);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 17, '                  свинина (47.22.11.110) ', '211', '47.22.11.110', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 18, '                  говядина (47.22.11.120) ', '212', '47.22.11.120', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 19, '         мясо домашней птицы и дичи (47.22.11.300) ', '213', '47.22.11.300', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 20, '         мясные продукты (47.22.12) ', '214', '47.22.12', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 21, '             из них консервы из мяса и субпродуктов пищевых (47.22.12.210) ', '215', '47.22.12.210', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 22, '      рыба, ракообразные и моллюски (47.23.1) ', '216', '47.23.1', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 23, '         из нее рыба и продукты из нее (47.23.11) ', '217', '47.23.11', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 24, '            из них консервы и пресервы из рыбы, икра и икорные изделия (47.23.11.410) ', '218', '47.23.11.410', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 25, '      хлебобулочные и мучные кондитерские изделия (47.24.11) (сумма строк 220 и 221)', '219', '47.24.11', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 26, '    в том числе:', NULL, NULL, NULL, NULL);  
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 27, '         хлеб и хлебобулочные изделия (47.24.11.100)', '220', '47.24.11.100', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 28, '         мучные кондитерские изделия (47.24.11.200)', '221', '47.24.11.200', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 29, '      сахаристые кондитерские изделия (47.24.12)', '222', '47.24.12', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 30, '      алкогольные напитки (47.25.11) (сумма строк с 224 по 229)', '223', '47.25.11', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 31, '         в том числе:', NULL, NULL, NULL, NULL);      
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 32, '         вино (47.25.11.100)', '224', '47.25.11.100', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 33, '         водка  (47.25.11.200) ', '225', '47.25.11.200', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 34, '         коньяк, коньячные напитки и бренди (47.25.11.300)', '226', '47.25.11.300', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 35, '         пиво (47.25.11.400) ', '227', '47.25.11.400', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 36, '         ликеры и изделия ликеро-водочные (47.25.11.500)', '228', '47.25.11.500', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 37, '         слабоалкогольные напитки (47.25.11.600) ', '229', '47.25.11.600', 'тысяч  рублей', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 38, '         алкогольные напитки прочие (47.25.11.900) ', '367', '47.25.11.900', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 39, '      безалкогольные напитки (47.25.12)', '230', '47.25.12', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 40, '         из них:', NULL, NULL, NULL, NULL);   
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 41, '         фруктовые и овощные соки (47.25.12.100)', '231', '47.25.12.100', 'тысяч  рублей', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 42, '         минеральная вода (47.25.12.200)', '232', '47.25.12.200', 'тысяч  рублей', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 43, '         нектары (47.25.12.300)', '233', '47.25.12.300', 'тысяч  рублей', 1);  
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 44, '         газированные безалкогольные напитки (47.25.12.400)', '234', '47.25.12.400', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 45, '      табачные изделия (47.26.10)', '235', '47.26.10', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 46, '      молочные продукты (47.29.11.100)', '236', '47.29.11.100', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 47, '         из них:', NULL, NULL, NULL, NULL);  
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 48, '         молоко (47.29.11.110)', '237', '47.29.11.110', 'тысяч  рублей', 1);      
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 49, '         сыры (47.29.11.120)', '238', '47.29.11.120', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 50, '         масло сливочное (47.29.11.130)', '239', '47.29.11.130', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 51, '         творог (47.29.11.150)', '240', '47.29.11.150', 'тысяч  рублей', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 52, '         мороженое (47.29.11.160)', '241', '47.29.11.160', 'тысяч  рублей', 1);       
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 53, '      яйца (47.29.12)', '242', '47.29.12', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 54, '      чай, кофе, какао и специи (47.29.21)', '243', '47.29.21', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 55, '         из них:', NULL, NULL, NULL, NULL);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 56, '         кофе и заменители кофе (47.29.21.100)', '244', '47.29.21.100', 'тысяч  рублей', 1); 
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 57, '         чай (47.29.21.200)', '245', '47.29.21.200', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 58, '         какао (47.29.21.300)', '246', '47.29.21.300', 'тысяч  рублей', 1);           
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 59, '      пищевые масла и жиры (47.29.22)', '247', '47.29.22', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 60, '         из них:', NULL, NULL, NULL, NULL);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 61, '         масло растительное (47.29.22.200)', '248', '47.29.22.200', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 62, '         майонез (47.29.22.320)', '249', '47.29.22.320', 'тысяч  рублей', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 63, '      гомогенизированные продукты и диетическое питание (47.29.23)', '250', '47.29.23', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 64, '      мед (47.29.29.100)', '251', '47.29.29.100', 'тысяч  рублей', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 65, '      крупа (47.29.29.200)', '252', '47.29.29.200', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 66, '         из нее:', NULL, NULL, NULL, NULL);   
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 67, '         крупа рисовая (47.29.29.210)', '253', '47.29.29.210', 'тысяч  рублей', 1); 
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 68, '         бобовые (47.29.29.270)', '254', '47.29.29.270', 'тысяч  рублей', 1);        
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 69, '      сахар и сахарозаменители (47.29.29.400)', '255', '47.29.29.400', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 70, '      соль пищевая (47.29.29.600)', '256', '47.29.29.600', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 71, '      мука (47.29.29.700)', '257', '47.29.29.700', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 72, '      макаронные изделия (47.29.29.800)', '258', '47.29.29.800', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 73, '      продукты пищевые прочие, не включенные в другие группировки (47.29.29.900)', '259', '47.29.29.900', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 74, '         из них:', NULL, NULL, NULL, NULL);  
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 75, '         продукты из зерновых культур для завтраков (47.29.29.910)', '260', '47.29.29.910', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 76, '         пельмени, вареники и аналогичные изделия (47.29.29.930)', '261', '47.29.29.930', 'тысяч  рублей', 1);            
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 77, '   непродовольственные товары (47.200) (сумма строк 263, 264, 266, 267, 269, 27, 275, 277, 280, 284, 286, с 297 по 31, 306, 307, 310, с 312 по 321, 324, 325, 328, 329, 338, 340, 341, 344, с 346 по 349, 351, 353, 355, 356, 358, с 361 по 363, 366)', '262', '47.200', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 78, '      в то числе:', NULL, NULL, NULL, NULL);      
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 79, '      легковые автомобили и грузовые автомобили весом не более 3,5 т (45.11.2)', '263', '45.11.2', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 80, '      прочие автотранспортные средства (45.19.2)', '264', '45.19.2', 'тысяч  рублей', 1); 
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 81, '         из них туристические автомобили, такие как автофургоны, автоприцепы для жилья (45.19.22)', '265', '45.19.22', 'тысяч  рублей', 1);        
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 82, '      детали и принадлежности для автотранспортных средств (45.32)', '266', '45.32', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 83, '      мотоциклы и относящиеся к ним детали и принадлежности (45.40.20)', '267', '45.40.20', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 84, '         из них мотоциклы, мотороллеры и мопеды (45.40.20.100)', '268', '45.40.20.100', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 85, '      моторное топливо и сопутствующие средства (47.30.10)', '269', '47.30.10', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 86, '      компьютеры, периферийные устройства и программное обеспечение (47.41.10)', '270', '47.41.10', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 87, '         из них:', NULL, NULL, NULL, NULL);   
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 88, '         компьютеры (47.41.10.100)', '271', '47.41.10.100', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 89, '         периферийное оборудование(47.41.10.200)', '272', '47.41.10.200', 'тысяч  рублей', 1); 
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 90, '           из них:', NULL, NULL, NULL, NULL);  
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 91, '           игровые приставки, джойстики и  другие аксессуары для видеоигр (47.41.10.210)', '273', '47.41.10.210', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 92, '           жесткие диски, карты памяти, накопители (47.41.10.230)', '274', '47.41.10.230', 'тысяч  рублей', 1);             
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 93, '      телекоммуникационное оборудование (47.42.10)', '275', '47.42.10', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 94, '         из него телефоны для сотовой и прочей беспроводной связи (47.42.10.300)', '276', '47.42.10.300', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 95, '      аудио- и видеоаппаратура (47.43.10)', '277', '47.43.10', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 96, '         из нее:', NULL, NULL, NULL, NULL);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 97, '         телевизоры (47.43.10.210)', '278', '47.43.10.210', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 98, '         видеокамеры (47.43.10.220)', '279', '47.43.10.220', 'тысяч  рублей', 1);   
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 99, '      ткани, пряжа, прочие текстильные изделия (47.51.11)', '280', '47.51.11', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 100, '         из них:', NULL, NULL, NULL, NULL);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 101, '        ткани (47.51.11.100)', '281', '47.51.11.100', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 102, '           из них ткани для пошива одежды (47.51.11.110)', '282', '47.51.11.110', 'тысяч  рублей', 1); 
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 103, '        нитки пряжа (47.51.11.200)', '283', '47.51.11.200', 'тысяч  рублей', 1);         
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 104, '     галантерейные товары (47.51.12)', '284', '47.51.12', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 105, '        из них швейные иглы, иглы для вязания и аналогичные товары для ручного труда (47.51.12.100)', '285', '47.51.12.100', 'тысяч  рублей', 1);      
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 106, '     строительные материалы (47.52) (сумма строк 287, с 291 по 295)', '286', '47.52', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 107, '        в том числе:', NULL, NULL, NULL, NULL);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 108, '        замочные, скобяные товары и ручные инструменты (47.52.11)', '287', '47.52.11', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 109, '           из них:', NULL, NULL, NULL, NULL);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 110, '           замки, петли и фернитура (47.52.11.100)', '288', '47.52.11.100', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 111, '           изделия крепежные, снабженные резьбой или без резьбы (47.52.11.300)', '289', '47.52.11.300', 'тысяч  рублей', 1);      
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 112, '           моторизованный ручной инструмент весом не более 10 кг (47.52.11.410)', '290', '47.52.11.410', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 113, '        лакокрасочные материалы (47.52.12)', '291', '47.52.12', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 114, '        стекло (47.52.13)', '292', '47.52.13', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 115, '        материалы и оборудование для изготовления поделок в домашних условиях (47.52.14)', '293', '47.52.14', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 116, '        санитарно-техническое оборудование (47.52.15)', '294', '47.52.15', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 117, '        строительные материалы, не включенные в другие группировки (47.52.16)', '295', '47.52.16', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 118, '          из них дома деревянные, сборные деревянные строения (включая сауны) (47.52.16.270)', '296', '47.52.16.270', 'тысяч  рублей', 1);       
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 119, '     портьеры и тюлевые занавеси (47.53.11)', '297', '47.53.11', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 120, '     обои (47.53.12.100)', '298', '47.53.12.100', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 121, '     напольные покрытия (47.53.12.200)', '299', '47.53.12.200', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 122, '     ковры и изделия ковровые (47.53.12.300)', '300', '47.53.12.300', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 123, '     электробытовые приборы и инструменты (47.54.10)', '301', '47.54.10', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 124, '          из них:', NULL, NULL, NULL, NULL);   
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 125, '          техника бытовая крупная (47.54.10.100)', '302', '47.54.10.100', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 126, '            из нее:', NULL, NULL, NULL, NULL);       
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 127, '            холодильники и морозильники бытовые (47.54.10.110)', '303', '47.54.10.100', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 128, '            стиральные машины бытовые и машины для сушки одежды (47.54.10.120)', '304', '47.54.10.120', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 129, '          приборы электрические для личной гигиены (47.54.10.200)', '305', '47.54.10.200', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 130, '     бытовая мебель (47.59.11)', '306', '47.59.11', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 131, '     осветительное оборудование (47.59.12)', '307', '47.59.12', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 132, '         из него:', NULL, NULL, NULL, NULL);   
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 133, '         лампы электрические (47.59.12.100)', '308', '47.59.12.100', 'тысяч  рублей', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 134, '         электрические провода и шнуры, электроустановочные изделия (47.59.12.200)', '309', '47.59.12.200', 'тысяч  рублей', 1);        
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 135, '     бытовая утварь, столовые принадлежности, посуда, стеклянные, фарфоровые и керамические изделия (47.59.13)', '310', '47.59.13', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 136, '         из нее бытовые механические приборы для приготовления пищи и напитков (47.59.13.100)', '311', '47.59.13.100', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 137, '     изделия из дерева, пробки и плетеные изделия (47.59.14)', '312', '47.59.14', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 138, '     бытовые неэлектрические приборы (47.59.15)', '313', '47.59.15', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 139, '     музыкальные инструменты и партитуры (47.59.19.100)', '314', '47.59.19.100', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 140, '     офисная мебель (47.59.19.200)', '315', '47.59.19.200', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 141, '     офисные машины и оборудование (47.59.19.300)', '316', '47.59.19.300', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 142, '     чистящие и прочие средства бытовой химии (47.59.19.400)', '317', '47.59.19.400', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 143, '     прочие оборудование, принадлежности и изделия, не включенные в другие группировки (47.59.19.900)', '318', '47.59.19.900', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 144, '     книги (47.61.10)', '319', '47.61.10', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 145, '     газеты и журналы (47.62.11)', '320', '47.62.11', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 146, '     бумага, картон, изделия из бумаги и канцелярские товары (47.62.12)', '321', '47.62.12', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 147, '         из них:', NULL, NULL, NULL, NULL);      
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 148, '         календари, конверты, открытки (47.62.12.400)', '322', '47.62.12.400', 'тысяч  рублей', 1); 
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 149, '         бумага туалетная и салфетки (47.62.12.500)', '323', '47.62.12.500', 'тысяч  рублей', 1);          
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 150, '     музыкальные и видеозаписи (47.63.10)', '324', '47.63.10', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 151, '     товары для физической культуры, спорта и туризма, включая велосипеды и лодки (47.64.10)', '325', '47.64.10', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 152, '        из них:', NULL, NULL, NULL, NULL);       
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 153, '        велосипеды (47.64.10.100)', '326', '47.64.10.100', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 154, '        лодки (47.64.10.200)', '327', '47.64.10.200', 'тысяч  рублей', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 155, '     игры и игрушки (47.65.10)', '328', '47.65.10', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 156, '     одежда (47.71.10)', '329', '47.71.10', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 157, '        из нее:', NULL, NULL, NULL, NULL);       
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 158, '        одежда верхняя (47.71.10.100)', '330', '47.71.10.100', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 159, '           из нее:', NULL, NULL, NULL, NULL);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 160, '           одежда трикотажная (47.71.10.110)', '331', '47.71.10.110', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 161, '           одежда кожаная (47.71.10.130)', '332', '47.71.10.130', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 162, '           мех, меховая одежда и изделия (47.71.10.140)', '333', '47.71.10.140', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 163, '        нижнее белье (47.71.10.200)', '334', '47.71.10.200', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 164, '        чулочно-носочные изделия (47.71.10.600)', '335', '47.71.10.600', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 165, '        головные уборы (47.71.10.700)', '336', '47.71.10.700', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 166, '        аксессуары для одежды (47.71.10.800)', '337', '47.71.10.800', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 167, '     обувь (47.72.11)', '338', '47.72.11', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 168, '        из нее обувь кожаная (47.72.11.100)', '339', '47.72.11.100', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 169, '     дорожные принадлежности и прочие изделия из кожи (47.72.12)', '340', '47.72.12', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 170, '     фармацевтические товары  (47.73.10)', '341', '47.73.10', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 171, '        из них:', NULL, NULL, NULL, NULL);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 172, '        лекарственные средства (47.73.10.100)', '342', '47.73.10.100', 'тысяч  рублей', 1); 
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 173, '        ветеринарные препараты (47.73.10.200)', '343', '47.73.10.200', 'тысяч  рублей', 1);       
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 174, '     медицинские и ортопедические товары (47.74.10)', '344', '47.74.10', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 175, '        из них ортопедические изделия и приспособления (47.74.10.200)', '345', '47.74.10.200', 'тысяч  рублей', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 176, '     парфюмерно-косметическая продукция и туалетные принадлежности (47.75.10)', '346', '47.75.10', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 177, '     цветы, растения, семена и удобрения (47.76.11)', '347', '47.76.11', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 178, '     домашние животные (питомцы), корма, принадлежности для них и средства ухода за ними (47.76.12)', '348', '47.76.12', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 179, '     часы (47.77.10.100)', '349', '47.77.10.100', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 180, '        из них часы наручные (47.77.10.110)', '350', '47.77.10.110', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 181, '     ювелирные изделия (47.77.10.200)', '351', '47.77.10.200', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 182, '        из них столовое серебро (47.77.10.210)', '352', '47.77.10.210', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 183, '     фотопринадлежности, оптические и точные приборы (47.78.11)', '353', '47.78.11', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 184, '        из них очки, контактные линзы для коррекции зрения (47.78.11.400)', '354', '47.78.11.400', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 185, '     предметы искусства (47.78.12)', '355', '47.78.12', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 186, '     сувениры, изделия народных художественных промыслов, предметы культового и религиозного назначения (47.78.13)', '356', '47.78.13', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 187, '        из них сувениры и изделия народных художественных промыслов (47.78.13.100)', '357', '47.78.13.100', 'тысяч  рублей', 1);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 188, '     бытовое жидкое топливо, газ в баллонах, уголь, древесное топливо (47.78.14)', '358', '47.78.14', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 189, '        из него:', NULL, NULL, NULL, NULL);       
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 190, '        газ в баллонах (47.78.14.200)', '359', '47.78.14.200', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 191, '        уголь, древесное топливо (47.78.14.600)', '360', '47.78.14.600', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 192, '     оружие и боеприпасы (47.78.15)', '361', '47.78.15', 'тысяч  рублей', 1);        
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 193, '     почтовые марки и монеты (47.78.16)', '362', '47.78.16', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 194, '     неподержанные непродовольственные товары, не включенные в другие группировки (47.78.19)', '363', '47.78.19', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 195, '        из них:', NULL, NULL, NULL, NULL);     
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 196, '        моторизованный инструмент и оборудование весом более 10 кг (47.78.19.100)', '364', '47.78.19.100', 'тысяч  рублей', 1);
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 197, '        товары домашнего обихода недлительного пользования (47.78.19.200)', '365', '47.78.19.200', 'тысяч  рублей', 1);    
    loadDefaultStatisticReportTypeDetail('1-торг(2021)', 198, '      подержанные товары (47.79.1)', '366', '47.79.1', 'тысяч  рублей', 1);    
      
    loadDefaultStStatisticReportTypeBy2021torg1tab4();           
    
    loadDefaultStatisticReportType ('12-торг (2021)', 'BYRTNEW', TRUE , 1000);
          
    loadDefaultStatisticReportTypeDetail('12-торг (2021)', 1, 'Розничный товарооборот (сумма строк 02 и 04)', '01', 'ВСЕ', NULL , 1);
    loadDefaultStatisticReportTypeDetail('12-торг (2021)', 2, '   в том числе продано:', NULL, NULL, NULL, NULL );
    loadDefaultStatisticReportTypeDetail('12-торг (2021)', 3, '   пищевых продуктов, напитков и табачных изделий', '02', '47.2', NULL, 1);
    loadDefaultStatisticReportTypeDetail('12-торг (2021)', 4, '      из них алкогольных напитков', '03', '47.25.11', NULL, 1);
    loadDefaultStatisticReportTypeDetail('12-торг (2021)', 5, '   непродовольственных товаров', '04', '47.200', NULL, 1);
    
    loadDefaultStatisticReportTypeDetail('12-торг (2021)', 6, 'Запасы товаров в торговых объектах и на складах на конец отчетного периода ', '05', NULL , NULL , NULL);
    loadDefaultStatisticReportTypeDetail('12-торг (2021)', 7, 'Товарооборот общественного питания (сумма строк 07 и 09)', '06',  NULL, NULL , NULL );
    loadDefaultStatisticReportTypeDetail('12-торг (2021)', 8, '   в том числе продано:', NULL, NULL, NULL, NULL );
    loadDefaultStatisticReportTypeDetail('12-торг (2021)', 9, '   пищевых продуктов, напитков и табачных изделий', '07', NULL , NULL, NULL);
    loadDefaultStatisticReportTypeDetail('12-торг (2021)', 10, '      из них алкогольных напитков', '08', NULL, NULL, NULL);
    loadDefaultStatisticReportTypeDetail('12-торг (2021)', 11, '   непродовольственных товаров', '09', NULL, NULL, NULL);  
    
    loadDefaultStatisticReportType ('4-торг (2021)', 'BYRTNEW', NULL , NULL);
     
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 1, 'Свежие фрукты и орехи (47.21.11.100)', '01', '47.21.11.100', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 2, '   из них свежие яблоки (47.21.11.111)', '66', '47.21.11.111', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 3, 'Свежие овощи и грибы (47.21.11.300)', '02', '47.21.11.300', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 4, '   из них свежий картофель (47.21.11.310)', '03', '47.21.11.310', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 5, '   из них капуста белокочанная свежая (47.21.11.321)', '67', '47.21.11.321', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 6, '   из них свекла столовая свежая (47.21.11.322)', '68', '47.21.11.322', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 7, '   из них свежая морковь (47.21.11.323)', '69', '47.21.11.323', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 8, '   из них свежие огурцы (47.21.11.324)', '70', '47.21.11.324', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 9, '   из них свежие томаты (47.21.11.325)', '71', '47.21.11.325', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 10, '   из них лук репчатый (47.21.11.326)', '72', '47.21.11.326', 'т', 1);    
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 11, 'Мясо и мясные продукты (47.22.1) (сумма строк 05 и 11)', '04', '47.22.1', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 12, '   в том числе:', NULL, NULL, NULL, NULL);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 13, '   мясо, включая мясо домашней птицы и дичи, и субпродукты пищевые (47.22.11) (сумма строк 06, 09, 10)', '05', '47.22.11', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 14, '      в том числе:', NULL,NULL, NULL, NULL);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 15, '      мясо (47.22.11.100)', '06', '47.22.11.100', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 16, '         из него:', NULL, NULL, NULL, NULL);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 17, '         свинина (47.22.11.110)', '07', '47.22.11.110', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 18, '         говядина (47.22.11.120)', '08', '47.22.11.120', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 19, '      пищевые субпродукты (47.22.11.200)', '09', '47.22.11.200', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 20, '      мясо домашней птицы и дичи (47.22.11.300)', '10', '47.22.11.300', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 21, '   мясные продукты (47.22.12)', '11', '47.22.12', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 22, '      из них консервы из мяса и субпродуктов пищевых (47.22.12.210)', '12', '47.22.12.210', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 23, 'Рыба, ракообразные и моллюски (47.23.1) (сумма строк 14 и 18)', '13', '47.23.1', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 24, '   в том числе:', NULL, NULL, NULL, NULL);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 25, '   рыба и продукты из нее (47.23.11)', '14', '47.23.11', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 26, '      из нее:', NULL, NULL, NULL, NULL);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 27, '      рыба (47.23.11.100)', '15', '47.23.11.100', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 28, '      рыба приготовленная или консервированная (47.23.11.400)', '16', '47.23.11.400', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 29, '         из них консервы и пресервы из рыбы, икра и икорные изделия (47.23.11.410)', '17', '47.23.11.410', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 30, '   ракообразные, моллюски и прочие морепродукты (47.23.19)', '18', '47.23.19', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 31, 'Мучные кондитерские изделия (47.24.11.200)', '19', '47.24.11.200', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 32, 'Сахаристые кондитерские изделия (47.24.12)', '20', '47.24.12', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 33, '   из них шоколад и кондитерские изделия, содержащие какао (47.24.12.100)', '21', '47.24.12.100', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 34, 'Вина виноградные (47.25.11.110)', '22', '47.25.11.110', 'дал', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 35, 'Вина плодовые (47.25.11.120)', '23', '47.25.11.120', 'дал', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 36, 'Вина игристые, включая шампанское (47.25.11.130)', '24', '47.25.11.130', 'дал', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 37, 'Водка (47.25.11.200)', '25', '47.25.11.200', 'дал', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 38, 'Коньяк, коньячные напитки и бренди (47.25.11.300)', '26', '47.25.11.300', 'дал', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 39, 'Пиво (47.25.11.400)', '27', '47.25.11.400', 'дал', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 40, 'Ликеры и изделия ликеро-водочные (47.25.11.500)', '28', '47.25.11.500', 'дал', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 41, 'Слабоалкогольные напитки (47.25.11.600)', '29', '47.25.11.600', 'дал', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 42, 'Алкогольные напитки прочие (47.25.11.900)', '77', '47.25.11.900', 'дал', 1); 
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 43, 'Фруктовые и овощные соки (47.25.12.100)', '30', '47.25.12.100', 'дал', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 44, 'Минеральная и питьевая вода в бутылках (47.25.12.200)', '31', '47.25.12.200', 'дал', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 45, 'Табачные изделия (47.26.10)', '32', '47.26.10', 'тыс. шт.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 46, 'Сыры (47.29.11.120)', '33', '47.29.11.120', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 47, 'Масло сливочное (47.29.11.130)', '34', '47.29.11.130', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 48, 'Яйца (47.29.12)', '35', '47.29.12', 'тыс. шт.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 49, 'Масло растительное (47.29.22.200)', '36', '47.29.22.200', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 50, '   из него масло рапсовое (47.29.22.210)', '79', '47.29.22.210', 'т', 1);  
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 51, 'Детское питание (47.29.23.100)', '37', '47.29.23.100', 'ц', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 52, '   из него:', NULL, NULL, NULL, NULL);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 53, '   сухие детские смеси и каши (47.29.23.110)', '73', '47.29.23.110', 'ц', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 54, '   консервы мясные и рыбные (47.29.23.130)', '74', '47.29.23.130', 'ц', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 55, '   консервы плодоовощные и соковая продукция (47.29.23.140)', '75', '47.29.23.140', 'ц', 1);               
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 56, 'Крупа (47.29.29.200)', '38', '47.29.29.200', 'ц', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 57, '   из нее:', NULL, NULL, NULL, NULL);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 58, '   крупа рисовая (47.29.29.210)', '39', '47.29.29.210', 'ц', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 59, '   крупа гречневая (47.29.29.220)', '40', '47.29.29.220', 'ц', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 60, '   крупа овсяная  и хлопья овсяные (47.29.29.250)', '41', '47.29.29.250', 'ц', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 61, 'Сахар и сахарозаменители (47.29.29.400)', '42', '47.29.29.400', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 62, 'Мука (47.29.29.700)', '43', '47.29.29.700', 'ц', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 63, 'Макаронные изделия (47.29.29.800)', '44', '47.29.29.800', 'ц', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 64, 'Новые легковые автомобили (45.11.21)', '45', '45.11.21', 'шт.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 65, 'Подержанные легковые автомобили (45.11.22)', '46', '45.11.22', 'шт.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 66, 'Моторное топливо (47.30.10.100)', '47', '47.30.10.100', 'тыс.руб.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 67, '   из него:', NULL, NULL, NULL, NULL);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 68, '   автомобильный бензин (47.30.10.110)', '48', '47.30.10.110', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 69, '   дизельное топливо (47.30.10.130)', '49', '47.30.10.130', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 70, 'Телевизоры (47.43.10.210)', '50', '47.43.10.210', 'шт.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 71, 'Строительные материалы (47.52)', '51', '47.52', 'тыс.руб.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 72, '   из них:', NULL, NULL, NULL, NULL);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 73, '   пиломатериалы (47.52.16.220)', '52', '47.52.16.220', 'м3', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 74, '   цемент (47.52.16.310)', '53', '47.52.16.310', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 75, '   плитки керамические (47.52.16.510)', '54', '47.52.16.510', 'м2', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 76, 'Холодильники и морозильники бытовые (47.54.10.110)', '55', '47.54.10.100', 'шт.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 77, 'Стиральные машины бытовые и машины для сушки одежды (47.54.10.120)', '56', '47.54.10.120', 'шт.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 78, 'Чистящие и прочие средства бытовой химии (47.59.19.400)', '57', '47.59.19.400', 'т', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 79, 'Велосипеды (47.64.10.100)', '76', '47.64.10.100', 'шт.', 1);     
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 80, 'Верхняя одежда (47.71.10.100)', '58', '47.71.10.100', 'тыс.руб.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 81, '   из нее одежда трикотажная (47.71.10.110)', '59', '47.71.10.110', 'тыс.руб.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 82, 'Нижнее белье (47.71.10.200)', '60', '47.71.10.200', 'тыс.руб.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 83, 'Чулочно-носочные изделия (47.71.10.600)', '61', '47.71.10.600', 'тыс.руб.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 84, 'Обувь (47.72.11)', '62', '47.72.11', 'тыс.руб.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 85, '   из нее обувь кожаная (47.72.11.100)', '63', '47.72.11.100', 'тыс.руб.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 86, 'Фармацевтические товары (47.73.10)', '64', '47.73.10', 'тыс.руб.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 87, 'Парфюмерно-косметическая продукция и туалетные принадлежности (47.75)', '65', '47.75', 'тыс.руб.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 88, 'Удобрения минеральные (47.76.11.411)', '78', '47.76.11.411', 'кг', 1);
    //далее строки для раздела 2 в отчете 4 торг
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 89, 'Розничный товарооборот  - всего(сумма строк 81 и 82)', '80', 'ВСЕ', 'тыс.руб.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 90, 'в том числе продано:', NULL, NULL, NULL, NULL);//если менять номер строки, то учесть в statisticGroup2R4T
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 91, 'пищевых продуктов, напитков и табачных изделий', '81', '47.2', 'тыс.руб.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 92, 'непродовольственных товаров', '82', '47.200', 'тыс.руб.', 1);
     loadDefaultStatisticReportTypeDetail('4-торг (2021)', 93, 'Товарооборот общественного питания ', '83', 'ВСЕ', 'тыс.руб.', 1);
}
loadDefaultStStatisticReportTypeBy2021Apply 'Загрузить типы стат отч 2021' (){
    NEWSESSION {
        loadDefaultStStatisticReportTypeBy2021();
        APPLY;
    }
}

loadDefaultStStatisticReportType () + {  loadDefaultStStatisticReportTypeBy2021(); }


loadDefaultStStatisticReportTypeBy2021torg1tab4Apply 'Загрузить тип стат отчета 1 торг 4 табл 2021'()  { 
    NEWSESSION {
        loadDefaultStStatisticReportTypeBy2021torg1tab4();
        APPLY;
    }
}

loadDefaultStStatisticReportTypeBy12torgOpt(){
    loadDefaultStatisticReportType ('12-торг (опт)', 'BYWSNEW', TRUE , 1000);

    loadDefaultStatisticReportTypeDetail('12-торг (опт)', 1, 'Легковые автомобили и грузовые автомобили весом не более 3,5т', '04', '45.11.1', NULL , 1);
    loadDefaultStatisticReportTypeDetail('12-торг (опт)', 2, 'Прочие автотранспортные средства', '05', '45.19.1', NULL, 1 );
    loadDefaultStatisticReportTypeDetail('12-торг (опт)', 3, 'Детали и принадлежности для автотранспортных средств', '06', '45.31.1', NULL, 1);
    loadDefaultStatisticReportTypeDetail('12-торг (опт)', 4, 'Мотоциклы и относящиеся к ним детали и принадлежности', '07', '45.40.1', NULL, 1);
    loadDefaultStatisticReportTypeDetail('12-торг (опт)', 5, 'Корма для животных', '08', '46.21.14', NULL, 1);
    loadDefaultStatisticReportTypeDetail('12-торг (опт)', 6, 'Табачные изделия', '09', '46.35.10', NULL , 1);
    loadDefaultStatisticReportTypeDetail('12-торг (опт)', 7, 'Фармацевические и медицинские товары и препараты', '10',  '46.46.11', NULL , 1);
    loadDefaultStatisticReportTypeDetail('12-торг (опт)', 8, 'Автомобильный бензин', '11', '46.71.12.100', NULL, 1);
    loadDefaultStatisticReportTypeDetail('12-торг (опт)', 9, 'Дизельное топливо', '12', '46.71.12.300' , NULL, 1);
    loadDefaultStatisticReportTypeDetail('12-торг (опт)', 10, 'Сырая нефть и попутный газ', '13', '46.71.13.100', NULL, 1);
    loadDefaultStatisticReportTypeDetail('12-торг (опт)', 11, 'Природный газ и сжиженные газы', '14', '46.71.13.200', NULL, 1);
    loadDefaultStatisticReportTypeDetail('12-торг (опт)', 12, 'Топочный мазут', '15', '46.71.13.300', NULL, 1);
    loadDefaultStatisticReportTypeDetail('12-торг (опт)', 13, 'Смазочные, охлаждающие и прочие средства, сопутствующие моторному топливу', '16', '46.71.13.500', NULL, 1);
    loadDefaultStatisticReportTypeDetail('12-торг (опт)', 14, 'Удобрения азотные', '17', '46.75.11.110', NULL, 1);
    loadDefaultStatisticReportTypeDetail('12-торг (опт)', 15, 'Удобрения фосфатные', '18', '46.75.11.120', NULL, 1);
    loadDefaultStatisticReportTypeDetail('12-торг (опт)', 16, 'Удобрения калийные', '19', '46.75.11.130', NULL, 1);

    loadDefaultStatisticReportType ('12-торг(опт) таб3', 'BYWSNEW', NULL , NULL);

    loadDefaultStatisticReportTypeDetail('12-торг(опт) таб3', 1, 'Автомобильный бензин', '21', '46.71.12.100', 'т', 1);
    loadDefaultStatisticReportTypeDetail('12-торг(опт) таб3', 2, 'Дизельное топливо', '22', '46.71.12.300', 'т', 1);
    loadDefaultStatisticReportTypeDetail('12-торг(опт) таб3', 3, 'Сырая нефть и попутный газ', '23', '46.71.13.100', 'т', 1);
    loadDefaultStatisticReportTypeDetail('12-торг(опт) таб3', 4, 'Природный газ и сжиженные газы', '24', '46.71.13.200', 'т', 1);
    loadDefaultStatisticReportTypeDetail('12-торг(опт) таб3', 5, 'Топочный мазут', '25', '46.71.13.300', 'т', 1);
    loadDefaultStatisticReportTypeDetail('12-торг(опт) таб3', 6, 'Удобрения калийные', '26', '46.75.11.130', 'т', 1);
}


loadDefaultStStatisticReportTypeBy12torgOptApply 'Загрузить тип стат отчета 12 торг(опт)'()  {
    NEWSESSION {
        loadDefaultStStatisticReportTypeBy12torgOpt();
        APPLY;
    }
}

EXTEND FORM options
    PROPERTIES () loadDefaultStStatisticReportTypeBy2021Apply, loadDefaultStStatisticReportTypeBy2021torg1tab4Apply, loadDefaultStStatisticReportTypeBy12torgOptApply
;
DESIGN options{
    statistics {
        MOVE PROPERTY (loadDefaultStStatisticReportTypeBy2021Apply());
        MOVE PROPERTY (loadDefaultStStatisticReportTypeBy2021torg1tab4Apply());
        MOVE PROPERTY (loadDefaultStStatisticReportTypeBy12torgOptApply());
    }
}

statisticGroup1T4T(StatisticReportDetail d)= sidStatisticGroup(d) == '47.71.10.600' OR sidStatisticGroup(d) =='47.71.10.110' OR sidStatisticGroup(d) =='47.71.10.210' OR sidStatisticGroup(d) =='47.72.11';

overFillData(StatisticReport report) + {
    IF id(statisticGroupType(report))=='BYRTNEW' AND name(report)=='1-торг(2021) таблица 4'  THEN {
        sold(StatisticReportDetail d) <- NULL WHERE statisticReport(d) == report;
        balance(StatisticReportDetail d) <- NULL WHERE statisticReport(d) == report;
        FOR StatisticGroup s == statisticGroup(StatisticReportDetail d) AND statisticReport(d) == report AND statisticGroup1T4T(d) AND
            Stock st == stock(report) AND DATE dFrom == fromDate(report) AND DATE dTo == toDate(report) NOINLINE DO {
            conversionFactor(statisticGroup(d)) <- NULL;
            sold(d) <-  NUMERIC[16,3](quantitySoldBy(s, st, dFrom, dTo));
            balance(d) <- NUMERIC[16,3] (balanceABy(s, st, dTo));
        }
    }
}
overFillDataRegion(StatisticReport report) + {
    IF id(statisticGroupType(report))=='BYRTNEW' AND name(report)=='1-торг(2021) таблица 4'  THEN {
        sold(StatisticReportDetail d) <- NULL WHERE statisticReport(d) == report;
        balance(StatisticReportDetail d) <- NULL WHERE statisticReport(d) == report;
        FOR StatisticGroup s == statisticGroup(StatisticReportDetail d) AND statisticReport(d) == report AND statisticGroup1T4T(d) AND
            LegalEntity c == company(report) AND Region r == region(report) AND DATE dFrom == fromDate(report) AND DATE dTo == toDate(report) NOINLINE DO {
            conversionFactor(statisticGroup(d)) <- NULL;
            sold(d) <-  NUMERIC[16,3](quantitySoldBy(s, c, r,dFrom, dTo));
            balance(d) <- NUMERIC[16,3] (balanceABy(s, c, r,dTo));
        }
    }
}
overFillDataLegalEntity(StatisticReport report) + {
    IF id(statisticGroupType(report))=='BYRTNEW' AND name(report)=='1-торг(2021) таблица 4'  THEN {
        sold(StatisticReportDetail d) <- NULL WHERE statisticReport(d) == report;
        balance(StatisticReportDetail d) <- NULL WHERE statisticReport(d) == report;
        FOR StatisticGroup s == statisticGroup(StatisticReportDetail d) AND statisticReport(d) == report AND statisticGroup1T4T(d) AND
            LegalEntity c == company(report) AND DATE dFrom == fromDate(report) AND DATE dTo == toDate(report) NOINLINE DO {
            conversionFactor(statisticGroup(d)) <- NULL;
            sold(d) <-  NUMERIC[16,3](quantitySoldBy(s, c,dFrom, dTo));
            balance(d) <- NUMERIC[16,3] (balanceABy(s, c,dTo));
        }
    }
}

sumCashCatering 'Продано за наличные(общепит)' (Stock st, DATE dateFrom, DATE dateTo) =
    GROUP
        SUM sumCash (ZReport z) IF isCatering(st) AND departmentStore(z) == st AND dateFrom <= date(z) AND dateTo >= date(z);
sumCashAll 'Продано всего за наличные' (Stock st, DATE dateFrom, DATE dateTo) =
    GROUP
        SUM sumCash (ZReport z) IF departmentStore(z) == st AND dateFrom <= date(z) AND dateTo >= date(z);


overFillData(StatisticReport report) + {
    IF id(statisticGroupType(report))=='BYRTNEW' AND name(report)=='4-торг (2021)'  THEN {
        FOR StatisticGroup s == statisticGroup(StatisticReportDetail d) AND statisticReport(d) == report AND statisticGroup2R4T(d) AND
            Stock st == stock(report) AND DATE dFrom == fromDate(report) AND DATE dTo == toDate(report) NOINLINE DO {
            sold(d) <- NULL;
            soldCatering(d) <- NULL;
            balance(d) <- NULL;
            balanceResident(d) <- NULL;
            soldSum(d) <- NULL;
            soldSumCatering(d) <- NULL;
            soldSumResident(d) <- NULL;
            soldSumCashCatering(d) <- NULL;
            soldSumCash(d) <- NULL;

            soldSum(d) <- NUMERIC[16,3](totalSumSoldBy(s, st, dFrom, dTo));
            soldSum(d) <- NUMERIC[16,3](soldSum(d) / 1000);
            soldSum(d) <- round(soldSum(d), round(d)) WHERE round(d) ;

            soldSumResident(d) <- NUMERIC[16,3](totalSumResidentSoldBy(s, st, dFrom, dTo));
            soldSumResident(d) <- NUMERIC[16,3](soldSumResident(d)/ 1000);
            soldSumResident(d) <- round(soldSumResident(d), round(d)) WHERE round(d) AND NOT number(d) == '83';
            
            soldSumCash(d) <- NUMERIC[16,3] (sumCashAll(st, dFrom, dTo));
            soldSumCash(d) <-NUMERIC[16,3](soldSumCash(d)/ 1000);
            soldSumCash(d) <- round(soldSumCash(d), round(d)) WHERE round(d);

            IF isPositiveReport(report) THEN {
                soldSum(d) <- 0.0 WHERE soldSum(d) < 0 ;
                soldSumResident(d) <- 0.0 WHERE soldSumResident(d) < 0 ;
                soldSumCatering(d) <- 0.0 WHERE soldSumCatering(d) < 0 ;
                soldSumResident(d) <- min(soldSumResident(d), soldSum(d));
                soldSumCash(d) <- 0.0 WHERE soldSumCash(d) < 0 ;
            }

            soldSum(d) <- (GROUP SUM soldSum(StatisticReportDetail detail) IF in(detail, d)) WHERE count(d) AND NOT skip(d);
            soldSumResident(d) <- (GROUP SUM soldSumResident(StatisticReportDetail detail)  IF in(detail, d)) WHERE count(d) AND NOT skip(d);

            IF number(d) == '83' THEN{
                soldSum(d) <- NUMERIC[16,3](totalSumCateringSoldBy(s, st, dFrom, dTo) / 1000);
                soldSum(d) <- round(soldSum(d), round(d)) WHERE round(d);
                soldSumCash(d) <- NUMERIC[16,3](sumCashCatering(st, dFrom, dTo) / 1000);
                soldSumCash(d) <- round(soldSumCash(d), round(d)) WHERE round(d);
                soldSumResident(d) <- NULL;
            }
        }
    }
}

sumCashCatering 'Продано за наличные(общепит)' (LegalEntity l , Region r, DATE dateFrom, DATE dateTo) =
    GROUP
        SUM sumCash (ZReport z) IF isCatering(departmentStore(z)) AND legalEntity(departmentStore(z)) == l AND region(departmentStore(z)) == r AND dateFrom <= date(z) AND dateTo >= date(z);
sumCashAll'Продано всего за наличные' (LegalEntity l , Region r, DATE dateFrom, DATE dateTo) =
    GROUP
        SUM sumCash (ZReport z) IF legalEntity(departmentStore(z)) == l AND region(departmentStore(z)) == r AND dateFrom <= date(z) AND dateTo >= date(z);

overFillDataRegion(StatisticReport report) + {
    IF id(statisticGroupType(report))=='BYRTNEW' AND name(report)=='4-торг (2021)'  THEN {
        FOR StatisticGroup s == statisticGroup(StatisticReportDetail d) AND statisticReport(d) == report AND statisticGroup2R4T(d) AND
            LegalEntity c == company(report) AND Region r == region(report) AND DATE dFrom == fromDate(report) AND DATE dTo == toDate(report) NOINLINE DO {
            sold(d) <- NULL;
            soldCatering(d) <- NULL;
            balance(d) <- NULL;
            balanceResident(d) <- NULL;
            soldSum(d) <- NULL;
            soldSumCatering(d) <- NULL;
            soldSumResident(d) <- NULL;
            soldSumCashCatering(d) <- NULL;
            soldSumCash(d) <- NULL;

            soldSum(d) <- NUMERIC[16,3](totalSumSoldBy(s, c, r, dFrom, dTo));
            soldSum(d) <- NUMERIC[16,3](soldSum(d) / 1000);
            soldSum(d) <- round(soldSum(d), round(d)) WHERE round(d) ;

            soldSumResident(d) <- NUMERIC[16,3](totalSumResidentSoldBy(s, c, r, dFrom, dTo));
            soldSumResident(d) <- NUMERIC[16,3](soldSumResident(d)/ 1000);
            soldSumResident(d) <- round(soldSumResident(d), round(d)) WHERE round(d) AND NOT number(d) == '83';

            soldSumCash(d) <- NUMERIC[16,3] (sumCashAll(c, r,  dFrom, dTo));
            soldSumCash(d) <-NUMERIC[16,3](soldSumCash(d)/ 1000);
            soldSumCash(d) <- round(soldSumCash(d), round(d)) WHERE round(d);

            IF isPositiveReport(report) THEN {
                soldSum(d) <- 0.0 WHERE soldSum(d) < 0 ;
                soldSumResident(d) <- 0.0 WHERE soldSumResident(d) < 0 ;
                soldSumCatering(d) <- 0.0 WHERE soldSumCatering(d) < 0 ;
                soldSumResident(d) <- min(soldSumResident(d), soldSum(d));
                soldSumCash(d) <- 0.0 WHERE soldSumCash(d) < 0 ;
            }

            soldSum(d) <- (GROUP SUM soldSum(StatisticReportDetail detail) IF in(detail, d)) WHERE count(d) AND NOT skip(d);
            soldSumResident(d) <- (GROUP SUM soldSumResident(StatisticReportDetail detail)  IF in(detail, d)) WHERE count(d) AND NOT skip(d);

            IF number(d) == '83' THEN{
                soldSum(d) <- NUMERIC[16,3](totalSumCateringSoldBy(s, c, r, dFrom, dTo) / 1000);
                soldSum(d) <- round(soldSum(d), round(d)) WHERE round(d);
                soldSumCash(d) <- NUMERIC[16,3](sumCashCatering(c, r, dFrom, dTo) / 1000);
                soldSumCash(d) <- round(soldSumCash(d), round(d)) WHERE round(d);
                soldSumResident(d) <- NULL;
            }
        }
    }
}

sumCashCatering 'Продано за наличные(общепит)' (LegalEntity l, DATE dateFrom, DATE dateTo) =
    GROUP
        SUM sumCash (ZReport z) IF isCatering(departmentStore(z)) AND legalEntity(departmentStore(z)) == l AND dateFrom <= date(z) AND dateTo >= date(z);

sumCashAll 'Продано всего за наличные' (LegalEntity l, DATE dateFrom, DATE dateTo) =
    GROUP
        SUM sumCash (ZReport z) IF legalEntity(departmentStore(z)) == l AND dateFrom <= date(z) AND dateTo >= date(z);

overFillDataLegalEntity(StatisticReport report) + {
    IF id(statisticGroupType(report))=='BYRTNEW' AND name(report)=='4-торг (2021)'  THEN {
        FOR StatisticGroup s == statisticGroup(StatisticReportDetail d) AND statisticReport(d) == report AND statisticGroup2R4T(d) AND
            LegalEntity c == company(report) AND DATE dFrom == fromDate(report) AND DATE dTo == toDate(report) NOINLINE DO {
            sold(d) <- NULL;
            soldCatering(d) <- NULL;
            balance(d) <- NULL;
            balanceResident(d) <- NULL;
            soldSum(d) <- NULL;
            soldSumCatering(d) <- NULL;
            soldSumResident(d) <- NULL;
            soldSumCashCatering(d) <- NULL;
            soldSumCash(d) <- NULL;

            soldSum(d) <- NUMERIC[16,3](totalSumSoldBy(s, c, dFrom, dTo));
            soldSum(d) <- NUMERIC[16,3](soldSum(d) / 1000);
            soldSum(d) <- round(soldSum(d), round(d)) WHERE round(d) ;

            soldSumResident(d) <- NUMERIC[16,3](totalSumResidentSoldBy(s, c, dFrom, dTo));
            soldSumResident(d) <- NUMERIC[16,3](soldSumResident(d)/ 1000);
            soldSumResident(d) <- round(soldSumResident(d), round(d)) WHERE round(d) AND NOT number(d) == '83';
            
            soldSumCash(d) <- NUMERIC[16,3] (sumCashAll(c, dFrom, dTo));
            soldSumCash(d) <-NUMERIC[16,3](soldSumCash(d)/ 1000);
            soldSumCash(d) <- round(soldSumCash(d), round(d)) WHERE round(d);


            IF isPositiveReport(report) THEN {
                soldSum(d) <- 0.0 WHERE soldSum(d) < 0 ;
                soldSumResident(d) <- 0.0 WHERE soldSumResident(d) < 0 ;
                soldSumCatering(d) <- 0.0 WHERE soldSumCatering(d) < 0 ;
                soldSumResident(d) <- min(soldSumResident(d), soldSum(d));
                soldSumCash(d) <- 0.0 WHERE soldSumCash(d) < 0 ;
            }

            soldSum(d) <- (GROUP SUM soldSum(StatisticReportDetail detail) IF in(detail, d)) WHERE count(d) AND NOT skip(d);
            soldSumResident(d) <- (GROUP SUM soldSumResident(StatisticReportDetail detail)  IF in(detail, d)) WHERE count(d) AND NOT skip(d);

            IF number(d) == '83' THEN{
                soldSum(d) <- NUMERIC[16,3](totalSumCateringSoldBy(s, c, dFrom, dTo) / 1000);
                soldSum(d) <- round(soldSum(d), round(d)) WHERE round(d);
                soldSumCash(d) <- NUMERIC[16,3](sumCashCatering(c, dFrom, dTo) / 1000);
                soldSumCash(d) <- round(soldSumCash(d), round(d)) WHERE round(d);
                soldSumResident(d) <- NULL;
            }
        }
    }
}
filterStatisticGroup2R4T = TRUE IF statisticGroup2R4T(StatisticReportDetail d) 
    AND id(statisticGroupType(statisticReport(d)))=='BYRTNEW' AND name(statisticReport(d))=='4-торг (2021)';


showIf2R4T(StatisticReport r)= GROUP SUM 1 IF statisticGroup2R4T(StatisticReportDetail d) AND statisticReport(d) == r
    AND id(statisticGroupType(r))=='BYRTNEW' AND name(r)=='4-торг (2021)';

EXTEND FORM statisticReport
    FILTERS NOT filterStatisticGroup2R4T(d)

    OBJECTS d2r4t = StatisticReportDetail
    PROPERTIES(d2r4t) READONLY index, name, number, nameStatisticGroup,
        sidStatisticGroup, nameUOM, round, childNumbers READONLY SHOWIF showDD(r),
        soldSum, soldSumResident, prevYearSoldSum, balanceSum
    FILTERS statisticReport(d2r4t) == r,  filterStatisticGroup2R4T(d2r4t)
;


DESIGN statisticReport {
    specificationBox {
        MOVE BOX(d2r4t) {
            caption = 'II Раздел' ;
            showIf = showIf2R4T(r);
        };
    }
}
